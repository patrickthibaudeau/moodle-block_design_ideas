define("block_design_ideas/questions",["exports","core/modal","core/str","core/ajax","core/templates"],(function(_exports,_modal,_str,_ajax,_templates){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modal=_interopRequireDefault(_modal),_ajax=_interopRequireDefault(_ajax),_templates=_interopRequireDefault(_templates);_exports.init=async()=>{document.addEventListener("click",(function(event){if(event.target.classList.contains("block-design-ideas-btn-ai-call-questions")){var clickedElement=event.target,promptId=clickedElement.getAttribute("data-prompt_id"),sectionId=clickedElement.getAttribute("data-topic_id"),courseId=clickedElement.getAttribute("data-course_id");_ajax.default.call([{methodname:"block_design_ideas_get_questions",args:{courseid:courseId,promptid:promptId,sectionid:sectionId}}])[0].done((function(results){_modal.default.create({title:(0,_str.get_string)("questions_generator","block_design_ideas"),body:_templates.default.render("block_design_ideas/questions",results),large:!0}).then((function(modal){modal.show(),modal.getRoot().on(_modal.default.events.hidden,(function(){var generateButton=document.getElementById("block-design-ideas-btn-generate");generateButton&&generateButton.remove()})),setTimeout((function(){var generateButton=document.getElementById("block-design-ideas-btn-generate");generateButton.addEventListener("click",(function(){var buttonText=generateButton.innerHTML,generatedContent=document.getElementById("block-design-ideas-generated-questions");generatedContent.innerHTML="";var content=document.getElementById("id_content").value,questionType=document.getElementById("id_question_type").value;generateButton.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',_ajax.default.call([{methodname:"block_design_ideas_generate_questions",args:{courseid:courseId,questiontype:questionType,content:content}}])[0].done((function(results){generateButton.innerHTML=buttonText,generatedContent.innerHTML=results.html,setTimeout((function(){var selectAllCheckbox=document.getElementById("block-design-ideas-subject-select-all");if(selectAllCheckbox){var checkboxes=document.querySelectorAll(".block-design-ideas-subject-select");selectAllCheckbox.addEventListener("change",(function(){checkboxes.forEach((function(checkbox){checkbox.checked=selectAllCheckbox.checked}))}))}var createButton=document.getElementById("block-design-ideas-btn-create-questions");createButton.addEventListener("click",(function(){var createButtonText=createButton.innerHTML,selectedCheckboxes=document.querySelectorAll(".block-design-ideas-subject-select:checked"),selectedIds=[];selectedCheckboxes.forEach((function(checkbox){var gift=checkbox.getAttribute("data-gift");selectedIds.push({question:gift})})),createButton.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',selectedIds=JSON.stringify(selectedIds),_ajax.default.call([{methodname:"block_design_ideas_save_questions",args:{question_type:questionType,courseid:courseId,questions:selectedIds}}])[0].done((function(){createButton.innerHTML=createButtonText,alert("Questions created successfully")}))}))}))}))}))}),1e3)}))})).fail((function(){alert("An error has occurred. Cannot display data")}))}}))}}));

//# sourceMappingURL=questions.min.js.map