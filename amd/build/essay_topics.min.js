define("block_design_ideas/essay_topics",["exports","core/modal_factory","core/ajax","core/templates"],(function(_exports,_modal_factory,_ajax,_templates){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modal_factory=_interopRequireDefault(_modal_factory),_ajax=_interopRequireDefault(_ajax),_templates=_interopRequireDefault(_templates);_exports.init=async()=>{document.addEventListener("click",(function(event){if(event.target.classList.contains("block-design-ideas-btn-ai-call-essay-topics")){var clickedElement=event.target,promptId=clickedElement.getAttribute("data-prompt_id"),sectionId=clickedElement.getAttribute("data-topic_id"),courseId=clickedElement.getAttribute("data-course_id");_modal_factory.default.create({title:"",body:_templates.default.render("block_design_ideas/loader",{}),large:!1}).then((function(modal){modal.show();var loaderModal=modal;_ajax.default.call([{methodname:"block_design_ideas_get_essay_topics",args:{courseid:courseId,promptid:promptId,sectionid:sectionId}}])[0].done((function(results){loaderModal.hide(),_modal_factory.default.create({title:results.section_name,body:_templates.default.render("block_design_ideas/essay_topics",results),large:!0}).then((function(modal){modal.show(),setTimeout((function(){var selectAllCheckbox=document.getElementById("block-design-ideas-subject-select-all");if(selectAllCheckbox){var checkboxes=document.querySelectorAll(".block-design-ideas-subject-select");selectAllCheckbox.addEventListener("change",(function(){checkboxes.forEach((function(checkbox){checkbox.checked=selectAllCheckbox.checked}))}))}var createSubjectsButton=document.querySelector(".block-design-ideas-btn-create-essay-topics");createSubjectsButton.addEventListener("click",(function(){modal.hide(),_modal_factory.default.create({title:"",body:_templates.default.render("block_design_ideas/loader",{}),large:!1}).then((function(modal){modal.show();var section=createSubjectsButton.getAttribute("data-section"),selectedCheckboxes=document.querySelectorAll(".block-design-ideas-subject-select:checked"),subjects=[];selectedCheckboxes.forEach((function(checkbox){var subjectName=checkbox.getAttribute("data-name"),subjectSummary=checkbox.getAttribute("data-summary");subjects.push({name:subjectName,summary:subjectSummary})})),subjects=JSON.stringify(subjects),_ajax.default.call([{methodname:"block_design_ideas_create_essay_topics",args:{section:section,courseid:courseId,subjects:subjects}}])[0].done((function(){window.location.reload()})).fail((function(){alert("An error has occurred. Cannot create topics")}))}))}))}),1e3)}))})).fail((function(){alert("An error has occurred. Cannot display data")}))}))}}))}}));

//# sourceMappingURL=essay_topics.min.js.map