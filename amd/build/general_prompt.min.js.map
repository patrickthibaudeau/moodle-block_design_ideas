{"version":3,"file":"general_prompt.min.js","sources":["../src/general_prompt.js"],"sourcesContent":["import ModalFactory from 'core/modal_factory';\nimport {get_string as getString} from 'core/str';\nimport ajax from 'core/ajax';\nimport Templates from 'core/templates';\n\nexport const init = async () => {\n    document.addEventListener('click', function (event) {\n\n        if (event.target.classList.contains('block-design-ideas-btn-ai-call')) {\n            var clickedElement = event.target;\n            // Get the data attributes\n            var promptId = clickedElement.getAttribute('data-prompt_id');\n            var courseId = clickedElement.getAttribute('data-course_id');\n            var name = clickedElement.getAttribute('data-name');\n\n            ModalFactory.create({\n                title: '',\n                body: Templates.render('block_design_ideas/loader', {}),\n                large: false\n            }).then(function (modal) {\n                modal.show();\n                var loaderModal = modal;\n\n                var get_content = ajax.call([{\n                    methodname: 'block_design_ideas_get_generic_content',\n                    args: {\n                        'courseid': courseId,\n                        'promptid': promptId\n                    }\n                }]);\n\n                get_content[0].done(function (results) {\n\n                    // Close the modal\n                    loaderModal.hide();\n                    results.name = name;\n\n                    // Show results.generatedcontent in a modal\n                    ModalFactory.create({\n                        title: getString('generated_content', 'block_design_ideas'),\n                        body: Templates.render('block_design_ideas/ai_call', results),\n                        large: true\n                    }).then(function (modal) {\n                        // Show Modal\n                        modal.show();\n                        // Set a timeout so that the element can be discovered in the DOM\n                        setTimeout(function () {\n                            // When buttin block-design-ideas-btn-copy-to-clipboard is clicked,\n                            // copy the content from id block-design-ideas-content to the clipboard\n                            var copyButton = document.querySelector('.block-design-ideas-btn-copy-to-clipboard');\n                            if (copyButton) {\n                                copyButton.addEventListener('click', function () {\n                                    var content = document.getElementById('block-design-ideas-content');\n                                    if (content) {\n                                        navigator.clipboard.writeText(content.innerText).then(function () {\n                                            getString('copied_to_clipboard', 'block_design_ideas').then(function (message) {\n                                                alert(message);\n                                            });\n                                        }, function () {\n                                            getString('copy_to_clipboard_failed', 'block_design_ideas').then(function (message) {\n                                                alert(message);\n                                            });\n                                        });\n                                    }\n                                });\n                            }\n\n                        }, 1000);\n                    });\n\n\n                }).fail(function () {\n                    alert('An error has occurred. Cannot display data');\n                });\n            });\n        }\n    });\n};"],"names":["async","document","addEventListener","event","target","classList","contains","clickedElement","promptId","getAttribute","courseId","name","create","title","body","Templates","render","large","then","modal","show","loaderModal","ajax","call","methodname","args","done","results","hide","setTimeout","copyButton","querySelector","content","getElementById","navigator","clipboard","writeText","innerText","message","alert","fail"],"mappings":"keAKoBA,UAChBC,SAASC,iBAAiB,SAAS,SAAUC,UAErCA,MAAMC,OAAOC,UAAUC,SAAS,kCAAmC,KAC/DC,eAAiBJ,MAAMC,OAEvBI,SAAWD,eAAeE,aAAa,kBACvCC,SAAWH,eAAeE,aAAa,kBACvCE,KAAOJ,eAAeE,aAAa,oCAE1BG,OAAO,CAChBC,MAAO,GACPC,KAAMC,mBAAUC,OAAO,4BAA6B,IACpDC,OAAO,IACRC,MAAK,SAAUC,OACdA,MAAMC,WACFC,YAAcF,MAEAG,cAAKC,KAAK,CAAC,CACzBC,WAAY,yCACZC,KAAM,UACUf,kBACAF,aAIR,GAAGkB,MAAK,SAAUC,SAG1BN,YAAYO,OACZD,QAAQhB,KAAOA,4BAGFC,OAAO,CAChBC,OAAO,mBAAU,oBAAqB,sBACtCC,KAAMC,mBAAUC,OAAO,6BAA8BW,SACrDV,OAAO,IACRC,MAAK,SAAUC,OAEdA,MAAMC,OAENS,YAAW,eAGHC,WAAa7B,SAAS8B,cAAc,6CACpCD,YACAA,WAAW5B,iBAAiB,SAAS,eAC7B8B,QAAU/B,SAASgC,eAAe,8BAClCD,SACAE,UAAUC,UAAUC,UAAUJ,QAAQK,WAAWnB,MAAK,+BACxC,sBAAuB,sBAAsBA,MAAK,SAAUoB,SAClEC,MAAMD,eAEX,+BACW,2BAA4B,sBAAsBpB,MAAK,SAAUoB,SACvEC,MAAMD,oBAO3B,WAIRE,MAAK,WACJD,MAAM"}